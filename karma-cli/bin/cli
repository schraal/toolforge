#!/bin/sh

# First try to get some information about the
# current script
#
# First get some directory information and then
# the name of the script.
#
DIRNAME=`dirname $0`
PROGNAME=`basename $0`

# If the KARMA_HOME environment variable is not defined
# we make a best-guess
#
if [ "x$KARMA_HOME" = "x" ]; then
    # Get the full path (without any relative bits)
    #
    KARMA_HOME=`cd $DIRNAME/..; pwd`
fi
export KARMA_HOME


# Of course we need a JAVA_HOME, we're java programmers, aren't we?
#
if [ "x$JAVA_HOME" = "x" ]; then
    echo "JAVA_HOME is not defined, exiting..."
    exit 1
fi
JAVACMD=$JAVA_HOME/bin/java
export JAVACMD

# Please note the inclusion of tools.jar from the jdk.
#
CLASSPATH=../lib/ant-1.6.1.jar:../lib/ant-launcher-1.6.1.jar:../lib/log4j-1.2.8.jar:../lib/cvslib-3.6.jar:../lib/commons-lang-1.0.1.jar:../lib/xerces-2.4.0.jar:../lib/xercesImpl-2.4.0.jar:../lib/xmlParserAPIs-2.2.1.jar:../lib/karma-core-2.0-dev.jar:../lib/toolforge-core-1.0-dev.jar:../lib/commons-logging-1.0.3.jar:../lib/commons-cli-1.0.jar:../lib/commons-io-20030203.000550.jar:../lib/commons-collections-2.1.jar:../lib/commons-beanutils-1.6.1.jar:../lib/maven-1.0.jar:../lib/commons-digester-1.5.jar:../target/classes:../resources
CLASSPATH=$CLASSPATH:$JAVA_HOME/lib/tools.jar

# Karma needs configuration files, we assume them in the $HOME/.karma directory
# and make sure the directory exists
#
if [ "x$KARMA_CONFIG_DIR" = "x" ]; then
	KARMA_CONFIG_DIR=`echo $HOME/.karma`
fi
export KARMA_CONFIG_DIR
mkdir -p $KARMA_CONFIG_DIR


# Now finally we are able to run karma
#
#$JAVACMD -cp $CLASSPATH -Dbootstrap.configuration=$HOME/.karma/karma.properties  -Druntime.mode=COMMAND_LINE -Dkarma.classloaderrepository.config=bin/karma.classpath -jar lib/karma-launcher-1.2.jar nl.toolforge.karma.cli.CLI $@
$JAVACMD -cp $CLASSPATH -Dbootstrap.configuration=$HOME/.karma/karma.properties  -Druntime.mode=COMMAND_LINE nl.toolforge.karma.cli.CLI $@



